{% extends "base.html" %}

{% block title %}Settings{% endblock %}

{% block content %}
<div class="container">
    <h1>Settings</h1>
    <form method="POST" action="{{ url_for('settings') }}">
        {{ settings_form.hidden_tag() }}
        <div class="form-group">
            {{ settings_form.ollama_url.label }}
            {{ settings_form.ollama_url }}
        </div>
        <div class="form-group">
            {{ settings_form.ollama_key.label }}
            {{ settings_form.ollama_key }}
        </div>
        <div class="form-group">
            {{ settings_form.model_name.label }}
            {{ settings_form.model_name }}
        </div>
        <div class="form-group">
            {{ settings_form.chatgpt_url.label }}
            {{ settings_form.chatgpt_url }}
        </div>
        <div class="form-group">
            {{ settings_form.chatgpt_key.label }}
            {{ settings_form.chatgpt_key }}
        </div>
        <div class="form-group">
            {{ settings_form.chatgpt_model.label }}
            {{ settings_form.chatgpt_model }}
        </div>
        <div class="form-group">
            {{ settings_form.openai_api_key.label }}
            {{ settings_form.openai_api_key }}
        </div>
        <div class="form-group">
            {{ settings_form.submit }}
        </div>
    </form>
    
    <h2>Manage Agents</h2>
    <form method="POST" action="{{ url_for('settings') }}">
        {{ agent_form.hidden_tag() }}
        <div class="form-group">
            {{ agent_form.name.label }}
            {{ agent_form.name }}
        </div>
        <div class="form-group">
            {{ agent_form.model.label }}
            {{ agent_form.model }}
        </div>
        <div class="form-group">
            {{ agent_form.is_openai.label }}
            {{ agent_form.is_openai }}
        </div>
        <div class="form-group">
            {{ agent_form.create_agent }}
        </div>
    </form>

    <div class="agent-list">
        <h3>Existing Agents</h3>
        <ul>
            {% for agent in agents %}
                <li>
                    <span>{{ agent.name }} ({{ agent.model }})</span>
                    <form method="POST" action="{{ url_for('settings') }}" style="display:inline;">
                        {{ agent_form.hidden_tag() }}
                        <input type="hidden" name="agent_id" value="{{ agent.id }}">
                        <button type="submit" name="remove_agent" value="remove_agent">Remove</button>
                    </form>
                </li>
            {% endfor %}
        </ul>
    </div>

    <div>
        <h2>Export/Import Settings</h2>
        <form method="GET" action="{{ url_for('export_settings') }}">
            <button type="submit">Export Settings</button>
        </form>
        <form method="POST" action="{{ url_for('import_settings') }}" enctype="multipart/form-data">
            {{ settings_form.csrf_token }}
            <input type="file" name="settings_file">
            <button type="submit">Import Settings</button>
        </form>
    </div>

    <div>
        <a href="{{ url_for('project_room') }}">Back to Projects</a>
    </div>
</div>
{% endblock %}
