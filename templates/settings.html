{% extends "base.html" %}

{% block head %}
    {{ super() }}
    <link rel="stylesheet" href="{{ url_for('static', filename='settings.css') }}">
{% endblock %}

{% block title %}Settings{% endblock %}

{% block content %}
<div class="main-content">
    <h1>Settings</h1>
    <div class="columns">
        <div class="column">
            <h2>Settings</h2>
            <form method="POST" action="{{ url_for('settings') }}">
                {{ settings_form.hidden_tag() }}
                <div>
                    {{ settings_form.ollama_url.label }}
                    {{ settings_form.ollama_url }}
                </div>
                <div>
                    {{ settings_form.ollama_key.label }}
                    {{ settings_form.ollama_key }}
                </div>
                <div>
                    {{ settings_form.model_name.label }}
                    {{ settings_form.model_name }}
                </div>
                <div>
                    {{ settings_form.openai_api_key.label }}
                    {{ settings_form.openai_api_key }}
                </div>
                <div>
                    <button type="submit">{{ settings_form.submit.label }}</button>
                </div>
            </form>
        </div>

        <div class="column">
            <h2>Manage Agents</h2>
            <form method="POST" action="{{ url_for('settings') }}">
                {{ agent_form.hidden_tag() }}
                <div>
                    {{ agent_form.name.label }}
                    {{ agent_form.name }}
                </div>
                <div>
                    {{ agent_form.model.label }}
                    {{ agent_form.model }}
                </div>
                <div>
                    {{ agent_form.is_openai.label }}
                    {{ agent_form.is_openai }}
                </div>
                <div>
                    <button type="submit">{{ agent_form.create_agent.label }}</button>
                </div>
            </form>

            <div class="existing-agents">
                <h3>Existing Agents</h3>
                <ul>
                    {% for agent in agents %}
                        <li>
                            <span>{{ agent.name }} ({{ agent.model }})</span>
                            <form method="POST" action="{{ url_for('settings') }}" style="display:inline;">
                                {{ agent_form.hidden_tag() }}
                                <input type="hidden" name="agent_id" value="{{ agent.id }}">
                                <button type="submit" name="remove_agent" value="remove_agent">Remove</button>
                            </form>
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <div class="export-import">
        <h2>Export/Import Settings</h2>
        <form method="GET" action="{{ url_for('export_settings') }}">
            <button type="submit">Export Settings</button>
        </form>
        <form method="POST" action="{{ url_for('import_settings') }}" enctype="multipart/form-data">
            {{ settings_form.csrf_token }}
            <input type="file" name="settings_file">
            <button type="submit">Import Settings</button>
        </form>
    </div>
</div>
{% endblock %}
